<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="Chop & Learn: Recognizing and Generating Object-state pairs">
  <meta name="keywords" content="ChopNLearn, chopNlearn">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chop & Learn</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <style>
    #selectObject {
      margin-left: 0.3%;
      /* margin-right: 10%; */
    }

    #selectState {
      margin-left: 0.3%;
      /* margin-right: 20px; */
    }

    #compGenTable table {
      width: 100%;
      border-collapse: collapse;
    }

    #compGenTable td,
    #compGenTable th {
      padding: 1%;
      text-align: center;
      font-weight: bold;
      vertical-align: middle;
    }
  </style>


</head>

<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Chop & Learn: Recognizing and Generating Object-State Compositions
            </h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://www.cs.umd.edu/~nirat/">Nirat Saini</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://hywang66.github.io/">Hanyu Wang</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://archana1998.github.io/">Archana Swaminathan</a>,
              </span>
              <span class="author-block">
                <a href="https://vinojjayasundara.github.io/">Vinoj Jayasundara</a>,
              </span>
              <span class="author-block">
                <a href="https://boheumd.github.io/">Bo He</a>,
              </span>
              <span class="author-block">
                <a href="https://kampta.github.io/">Kamal Gupta</a>,
              </span>
              <span class="author-block">
                <a href="http://www.cs.umd.edu/~abhinav/">Abhinav Shrivastava</a>
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block">University of Maryland, College Park</span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <FONT COLOR="#ff0000"> (ICCV 2023) </FONT>
              </span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- Dataset Link. -->
                <span class="link-block">
                  <a href="https://drive.google.com/drive/folders/1QylDeUJ8h-CjLRJ8Z9bsdCoQ2uMs59W_"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="far fa-images"></i>
                    </span>
                    <span>Data</span>
                  </a>

              </div>
            </div>
            <div class="columns is-centered has-text-centered">
              <div class="column is-four-fifths">
                <!-- <h2 class="title is-4">Teaser Video</h2> -->
                <div class="publication-video">
                  <video id="teaser" autoplay muted loop playsinline height="100%" controls>
                    <source src="./static/videos/trailer_dataset1_final.mp4" type="video/mp4">
                  </video>
                </div>
              </div>
            </div>
            <div class="subtitle has-text-centered">
              <!-- <h2 class="title is-5">
        More details coming soon
      </h2> </div> -->
            </div>

          </div>
        </div>
      </div>
  </section>




  <!-- Abstract -->
  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Recognizing and generating object-state compositions has been a challenging task, especially when
              generalizing to unseen compositions.
              In this paper, we study the task of cutting objects in different styles and the resulting object state
              changes.
              We propose a new benchmark suite Chop & Learn, to accommodate the needs of learning objects and different
              cut styles using multiple viewpoints.
              We also propose a new task of Compositional Image Generation, which can transfer learned cut styles to
              different objects,
              by generating novel object-state images.
              Moreover, we also use the videos for Compositional Action Recognition,
              and show valuable uses of this dataset for multiple video tasks.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>



  <!-- Dataset Collection and Statistics -->
  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column">
          <h2 class="title is-3">Dataset Collection and Statistics</h2>
          <div class="content has-text-justified">
            <p>ChopNLearn is collected with:</p>
            <ul>
              <li><b>3</b> participants</li>
              <li><b>4</b> cameras from different viewpoints</li>
              <li><b>20</b> objects and <b>7</b> styles of cutting (+1 with whole)</li>
              <li><b>112</b> compositions of object state pairs</li>
              <li><b>1338</b> images of state-object compositions</li>
              <li><b>1260</b> videos (ranging from 16 seconds to ~12 minutes)</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-11">
          <img src="./static/images/intro.jpg" alt="dataset_collection" width="100%">
        </div>
      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column">
          <div class="content has-text-justified">
            <p>
              We show the number of
              samples for each object-style composition in a color-coded manner:
            </p>
            <p>
              <span
                style="display: inline-block; width: 1em; height: 1em; background-color: #f7cbaf; vertical-align: center;"></span>
              orange represents 12 samples
            </p>
            <p>
              <span
                style="display: inline-block; width: 1em; height: 1em; background-color: #c5dfb4; vertical-align: center;"></span>
              green represents 8 samples
            </p>
            <p>
              <span
                style="display: inline-block; width: 1em; height: 1em; background-color: #bcd8ee; vertical-align: center;"></span>
              blue represents 4 samples.
            </p>
          </div>
        </div>
      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-9">
          <img src="./static/images/stats.jpg" alt="dataset_statistics" width="100%">
        </div>
      </div>
  </section>


  <!-- Compositional Generation Results -->
  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <!-- <div class="columns is-centered"> -->
        <div class="column">
          <h2 class="title is-3">Compositional Image Generation Results</h2>
          <div class="content has-text-justified">
            <p>
              <b>Compositional Image Generation</b>: Given training images of various objects in different states,
              generate new images of unseen pairs of objects and states.
            </p>
            <p>
              We consider these methods:
            </p>
            <ul>
              <li><b>Stable Diffusion (SD)</b></li>
              <li><b>Stable Diffusion + Textual Inversion (SD + TI)</b></li>
              <li><b>DreamBooth</b></li>
              <li><b>Stable Diffusion + Fine-tuning (FT)</b></li>
              <li><b>Stable Diffusion + Textual Inversion + Fine-tuning (SD + TI + FT)</b></li>
            </ul>
            <p>
              <b>Ground Truth (GT)</b> real images are shown in the first row for reference.
            </p>
            <!-- Please select different objects and states to view the generated images. -->

            <p>
              Please select different splits, objects, and states to view the generated images of different
              compositions.
            </p>
          </div>


          <!-- Selection boxes -->
          <div class="columns is-centered has-text-centered">
            <div class="column is-4">
              <div class="content">
                <label style="font-size: 100%"> Choose a Split </label>
                <select style="font-size: 100%; width: 36%;" id="selectSplit" onchange="updateSelectObject()">
                  <option value="seen">seen</option>
                  <option value="unseen">unseen</option>
                  <option value="all">all</option>
                </select>
              </div>
            </div>

            <div class="column is-4">
              <div class="content">
                <label style="font-size: 100%"> Choose an Object </label>
                <select style="font-size: 100%; width: 36%;" id="selectObject" onchange="updateSelectState()">
                </select>
              </div>
            </div>

            <div class="column is-4">
              <div class="content">
                <label style="font-size: 100%"> Choose a State </label>
                <select style="font-size: 100%; width: 36%;" id="selectState" onchange="updateCompGenImages()">
                </select>
              </div>
            </div>
          </div>

          <!-- Table for images and descriptions -->
          <div class="columns is-centered has-text-centered">
            <div class="column is-11">
              <table>
                <tbody id="compGenTable">
                  <!-- Rows will be dynamically populated -->
                </tbody>
              </table>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>




  <!-- What else can Chop & Learn be used for? -->
  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title">What else can Chop & Learn be used for?</h2>
        </div>
      </div>

      <br>

      <div class="columns is-centered">
        <div class="column is-full-width">
          <h3 class="title is-4">Capture Long-Term Object-State transformations from Videos</h3>
          <video id="transformations" autoplay muted loop playsinline height="100%" controls>
            <source src="./videos/video_parse.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <br>

      <div class="columns is-centered">
        <div class="column is-full-width">
          <h3 class="title is-4">Intermediate state/frame interpolation for Video Generation</h3>
          <video id="transformations" autoplay muted loop playsinline height="100%" controls>
            <source src="./videos/interpolating_frames.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <br>

      <div class="columns is-centered">
        <div class="column is-full-width">
          <h3 class="title is-4">Replace <font color="green">green screen</font> with realistic
            backgrounds</h3>
        </div>
      </div>

      <div class="columns is-centered">
        <div class="column is-9">
          <img src="./static/images/gs_removed.jpg" alt="green_screen" width="100%">
        </div>
      </div>

      <br>

      <div class="columns is-centered">
        <div class="column is-full-width">
          <h3 class="title is-4">Learn NeRF models for deformable objects</h3>
        </div>
      </div>

      <div class="columns is-centered">
        <div class="column is-full-width">
          <p>
            Results of 3D reconstruction using <a href="https://lukemelas.github.io/realfusion/">RealFusion</a>.
          </p>
          <p>
            Input images are shown on the top row, and the corresponding 3D reconstructions are shown on the bottom row.
          </p>
        </div>
      </div>

      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <div class="column is-full-width has-text-centered">
              <!-- <p>Successful Examples</p> -->
              <big style="font-size:20px; font-weight:bold">
                Successful
              </big>
            </div>

            <div class="columns is-full-width">
              <div class="column is-3 has-text-centered">
                <img src="./static/realfusion/pear_j.png" alt="apple_j" width="200px">
                <br>
                <video id="realfusion1" autoplay muted loop playsinline width="200px">
                  <source src="./static/realfusion/pear_j_cam1.mp4" type="video/mp4">
                </video>
                <br>
                <p class="subtitle is-6">Pear<br>Julienne</p>
              </div>

              <div class="column is-3 has-text-centered">
                <img src="./static/realfusion/squash_sc.png" alt="squash_sc" width="200px">
                <br>
                <video id="realfusion2" autoplay muted loop playsinline width="200px">
                  <source src="./static/realfusion/squash_sc_cam1.mp4" type="video/mp4">
                </video>
                <br>
                <p class="subtitle is-6">Squash<br>Small Cut</p>
              </div>

              <div class="column is-3 has-text-centered">
                <img src="./static/realfusion/watermelon_hrs.png" alt="watermelon_hrs" width="200px">
                <br>
                <video id="realfusion2" autoplay muted loop playsinline width="200px">
                  <source src="./static/realfusion/watermelon_hrs_cam3.mp4" type="video/mp4">
                </video>
                <br>
                <p class="subtitle is-6">Watermelon<br>Half Round Slices</p>
              </div>

              <div class="column is-3 has-text-centered">
                <img src="./static/realfusion/potato_b.png" alt="potato_b" width="200px">
                <br>
                <video id="realfusion2" autoplay muted loop playsinline width="200px">
                  <source src="./static/realfusion/potato_b_cam2.mp4" type="video/mp4">
                </video>
                <br>
                <p class="subtitle is-6">Potato<br>Baton</p>
              </div>
            </div>
          </div>
        </div>


        <div class="column is-4">
          <div class="content">
            <div class="column is-full-width has-text-centered">
              <!-- <p>Successful Examples</p> -->
              <big style="font-size:20px; font-weight:bold">
                Unsuccessful
              </big>
            </div>

            <div class="columns is-centered">
              <div class="column is-6 has-text-centered">
                <img src="./static/realfusion/onion_rs.png" alt="onion_rs" width="200px">
                <br>
                <video id="realfusion1" autoplay muted loop playsinline width="200px">
                  <source src="./static/realfusion/onion_rs_cam3.mp4" type="video/mp4">
                </video>
                <br>
                <p class="subtitle is-6">Onion<br>Round Slices</p>
              </div>
            </div>
          </div>
        </div>



      </div>

      <br>

      <div class="columns is-centered">
        <div class="column is-full-width">
          <h3 class="title is-4">Intermediate frame generation</h3>
          <video id="transformations" autoplay muted loop playsinline height="100%" controls>
            <source src="./videos/granulary_control.mp4" type="video/mp4">
          </video>
        </div>

      </div>
  </section>



  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <p>
          Credits for this awesome template goes to <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>
          website.
        </p>
      </div>
    </div>
    </div>
    </div>
  </footer>



  <script>
    var metadata = {
      "object_states": {
        "cantaloupe": ["b", "hrs", "w", "rs", "sc", "lc"],
        "apple": ["w", "rs", "sc", "lc", "b", "j", "hrs"],
        "squash": ["lc", "b", "rs", "hrs", "w", "sc", "j"],
        "cucumber": ["j", "hrs", "w", "rs", "sc", "lc", "b"],
        "mango": ["sc", "lc", "b", "w"],
        "lemon": ["hrs", "w", "rs", "sc", "lc"],
        "pear": ["b", "hrs", "w", "rs", "sc", "j", "lc"],
        "kiwi": ["rs", "sc", "lc", "hrs", "w"],
        "watermelon": ["hrs", "rs", "sc", "w", "lc", "b"],
        "turnip": ["b", "hrs", "w", "rs", "sc", "j", "lc"],
        "persimmon": ["lc", "hrs", "w", "rs", "sc"],
        "potato": ["rs", "w", "lc", "b", "sc", "j", "hrs"],
        "bellpepper": ["j", "w", "sc", "lc", "b"],
        "onion": ["w", "lc", "hrs", "rs", "sc"],
        "banana": ["lc", "b", "hrs", "w", "rs", "sc"],
        "tomato": ["hrs", "w", "sc", "lc", "rs"],
        "carrot": ["lc", "b", "j", "hrs", "w", "rs", "sc"],
        "broccoli": ["w", "lc", "sc"],
        "orange": ["hrs", "w", "rs", "sc", "lc"],
        "cauliflower": ["w", "lc", "sc"]
      },
      "object_states_seen": {
        'cantaloupe': ['b', 'hrs', 'rs', 'lc', 'w', 'sc'],
        'cucumber': ['j', 'w', 'sc', 'b', 'hrs', 'rs', 'lc'],
        'mango': ['sc', 'b', 'lc'],
        'kiwi': ['rs', 'lc', 'sc', 'hrs'],
        'turnip': ['b', 'hrs', 'w', 'sc', 'j'],
        'lemon': ['w', 'hrs', 'lc'],
        'squash': ['b', 'hrs', 'lc', 'rs', 'w', 'j'],
        'onion': ['w', 'lc', 'sc', 'hrs'],
        'banana': ['lc', 'w', 'sc', 'b', 'hrs', 'rs'],
        'orange': ['hrs', 'rs', 'lc', 'w', 'sc'],
        'tomato': ['w', 'lc', 'rs'],
        'pear': ['w', 'b', 'rs', 'lc'],
        'watermelon': ['sc', 'b', 'rs', 'w', 'lc'],
        'broccoli': ['sc'],
        'apple': ['lc', 'w', 'sc', 'b', 'hrs'],
        'carrot': ['j', 'w', 'sc', 'hrs', 'rs'],
        'persimmon': ['w', 'sc', 'rs'],
        'bellpepper': ['lc', 'j', 'sc'],
        'potato': ['hrs', 'rs', 'w', 'lc', 'sc', 'j'],
        'cauliflower': ['w', 'lc', 'sc']
      },
      "object_states_unseen": {
        'tomato': ['sc', 'hrs'],
        'turnip': ['rs', 'lc'],
        'pear': ['sc', 'j', 'hrs'],
        'watermelon': ['hrs'],
        'persimmon': ['lc', 'hrs'],
        'potato': ['b'],
        'apple': ['rs', 'j'],
        'carrot': ['lc', 'b'],
        'squash': ['sc'],
        'broccoli': ['w', 'lc'],
        'lemon': ['rs', 'sc'],
        'mango': ['w'],
        'bellpepper': ['w', 'b'],
        'onion': ['rs'],
        'kiwi': ['w']
      },
      "state_abbr": {
        "j": "julienne", "b": "baton", "hrs": "half round", "rs": "round slice", "sc": "small cut", "lc": "large cut", "w": "whole"
      },
      "name_shorten": {
        "ground_truth": "GT", "sd": "SD", "sd_text_inv": "SD+TI", "dreambooth": "DreamBooth", "sd_finetune": "SD+FT", "sd_finetune_text_inv": "SD+FT+TI"
      }
    }

    // When the document is fully loaded
    window.onload = function () {
      // const selectObject = document.getElementById('selectObject');
      // const attributes = Object.keys(metadata.object_states);
      // for (let attribute of attributes) {
      //   let option = document.createElement('option');
      //   option.value = attribute;
      //   option.textContent = attribute;
      //   selectObject.appendChild(option);
      // }
      // updateSelectState()
      updateSelectObject();
    };


    function hasOption(selectId, optionValue) {
      // Get the select element by its id
      var selectElement = document.getElementById(selectId);

      // Iterate over all options of the select element
      for (var i = 0; i < selectElement.options.length; i++) {
        if (selectElement.options[i].value === optionValue) {
          // The option with the specified value was found
          return true;
        }
      }

      // The option was not found
      return false;
    }

    function updateSelectObject() {
      const selectObject = document.getElementById('selectObject');
      const prevSelectedObject = selectObject.value;
      selectObject.innerHTML = '';  // Clear current options

      const selectSplit = document.getElementById('selectSplit').value;

      let attributes;
      if (selectSplit == 'seen') {
        attributes = Object.keys(metadata.object_states_seen);
      } else if (selectSplit == 'unseen') {
        attributes = Object.keys(metadata.object_states_unseen);
      } else if (selectSplit == 'all') {
        attributes = Object.keys(metadata.object_states);
      }



      for (let attribute of attributes) {
        let option = document.createElement('option');
        option.value = attribute;
        option.textContent = attribute;
        selectObject.appendChild(option);
      }

      if (hasOption('selectObject', prevSelectedObject)) {
        selectObject.value = prevSelectedObject;
      }

      updateSelectState()

    }

    function updateSelectState() {
      const selectState = document.getElementById('selectState');
      const prevSelectedState = selectState.value;
      selectState.innerHTML = '';  // Clear current options

      const selectSplit = document.getElementById('selectSplit').value;

      let object_states;
      if (selectSplit == 'seen') {
        object_states = metadata.object_states_seen;
      } else if (selectSplit == 'unseen') {
        object_states = metadata.object_states_unseen;
      } else if (selectSplit == 'all') {
        object_states = metadata.object_states;
      }

      const selectObject = document.getElementById('selectObject').value;
      const states = object_states[selectObject];

      // Iterate over the attributesB list and populate the selectState options
      for (let attribute of states) {
        selectState.options.add(new Option(metadata.state_abbr[attribute], attribute));
      }

      if (hasOption('selectState', prevSelectedState)) {
        selectState.value = prevSelectedState;
      }

      // Trigger image update
      updateCompGenImages();
    }

    function updateCompGenImages() {
      const table = document.getElementById('compGenTable');
      table.innerHTML = '';  // Clear current rows

      const selectObject = document.getElementById('selectObject').value;
      const selectState = document.getElementById('selectState').value;

      // Based on selectedA and selectedB, generate rows with descriptions and images
      for (methodName in metadata.name_shorten) {
        const row = table.insertRow();
        const descCell = row.insertCell(0);
        descCell.innerText = metadata.name_shorten[methodName];  // Add appropriate descriptions
        descCell.style = "font-weight: bold; font-size: 16px; padding: 0%;"

        for (let j = 0; j < 4; j++) {
          const imgCell = row.insertCell(j + 1);
          const img = document.createElement('img');
          const imagePath = `./static/result_images/${methodName}_${selectObject}_${selectState}_${j}.jpg`;
          img.src = imagePath;
          imgCell.appendChild(img);
        }
      }
    }


  </script>

</body>

</html>